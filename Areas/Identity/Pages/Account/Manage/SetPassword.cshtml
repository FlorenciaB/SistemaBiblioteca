@page
@model SistemaBiblioteca.Areas.Identity.Pages.Account.Manage.ChangePasswordModel
@{
    ViewData["Title"] = "Cambiar Contraseña";
    ViewData["ActivePage"] = ManageNavPages.ChangePassword;
}

<div class="d-flex justify-content-center mt-5">
    <div class="card shadow-sm" style="width: 400px;">
        <div class="card-body">
            <h3 class="card-title text-center mb-4">🔑 Cambiar Contraseña</h3>

            @if (!ViewData.ModelState.IsValid)
            {
                <div class="alert alert-danger">
                    <ul class="mb-0">
                        @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                        {
                            <li>@error.ErrorMessage</li>
                        }
                    </ul>
                </div>
            }

            <form method="post" novalidate>
                <!-- Contraseña actual -->
                <div class="mb-3">
                    <label asp-for="Input.Password" class="form-label">Contraseña actual</label>
                    <div class="input-group">
                        <input asp-for="Input.Password" class="form-control" type="password" id="Password" />
                        <span class="input-group-text password-toggle" onclick="togglePassword('Password', this)">
                            <i class="bi bi-eye"></i>
                        </span>
                    </div>
                </div>

                <!-- Nueva contraseña -->
                <div class="mb-3">
                    <label asp-for="Input.NuevaPassword" class="form-label">Nueva contraseña</label>
                    <div class="input-group">
                        <input asp-for="Input.NuevaPassword" class="form-control" type="password" id="NuevaPassword" />
                        <span class="input-group-text password-toggle" onclick="togglePassword('NuevaPassword', this)">
                            <i class="bi bi-eye"></i>
                        </span>
                    </div>
                </div>

                <!-- Confirmar nueva contraseña -->
                <div class="mb-3">
                    <label asp-for="Input.ConfirmarPassword" class="form-label">Confirmar nueva contraseña</label>
                    <div class="input-group">
                        <input asp-for="Input.ConfirmarPassword" class="form-control" type="password" id="ConfirmarPassword" />
                        <span class="input-group-text password-toggle" onclick="togglePassword('ConfirmarPassword', this)">
                            <i class="bi bi-eye"></i>
                        </span>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary w-100">Cambiar contraseña</button>
            </form>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .password-toggle i {
            transition: color 0.3s;
            color: #6c757d; /* gris inicial */
        }

        /* Cambia color cuando el input está enfocado */
        .input-group:has(input:focus) .password-toggle i {
            color: #0d6efd; /* azul Bootstrap */
        }

        .password-toggle:hover i {
            color: #0d6efd;
        }
    </style>
}

@section Scripts {
    <script>
        function togglePassword(inputId, iconSpan) {
            const input = document.getElementById(inputId);
            const icon = iconSpan.querySelector("i");
            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove("bi-eye");
                icon.classList.add("bi-eye-slash");
            } else {
                input.type = "password";
                icon.classList.remove("bi-eye-slash");
                icon.classList.add("bi-eye");
            }
        }
    </script>
}
